<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>å‡è‚¥è®ºå› Â· éšè—ç‰ˆï¼ˆè®ºå›è§£è°œç‰ˆï¼‰</title>
<style>
:root {
  --bg: #f4f4f4;
  --text: #222;
  --card: #fff;
  --border: #ccc;
}
body.dark {
  --bg: #1b1b1b;
  --text: #e6e6e6;
  --card: #2b2b2b;
  --border: #555;
}
body {
  background: var(--bg);
  color: var(--text);
  font-family: "Microsoft YaHei", sans-serif;
  transition: background 0.4s, color 0.4s;
  padding: 20px;
}
#container {
  width: 800px;
  margin: auto;
}
header {
  margin-bottom: 20px;
  text-align: center;
}
#themeBtn {
  margin-left: 10px;
}
forum-section, .forum-section {
  /* placeholder */
}
.post-list, .post-view {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 15px;
  margin-bottom: 20px;
}
.post-item {
  padding: 10px;
  border-bottom: 1px solid var(--border);
  cursor: pointer;
}
.post-item:last-child { border-bottom: none; }
.post-item:hover { background: rgba(0,0,0,0.03); }
.post-title { font-size: 1.2em; margin: 0; }
.post-meta { font-size: 0.9em; color: #666; }
.reply-section {
  margin-top: 20px;
  padding-top: 10px;
  border-top: 1px solid var(--border);
}
.reply-item {
  padding: 8px;
  border-bottom: 1px solid var(--border);
}
.reply-item:last-child { border-bottom: none; }
#newReply {
  margin-top: 15px;
}
#notes { background: var(--card); border:1px solid var(--border); border-radius:8px; padding:10px; max-height:150px; overflow-y:auto; }

</style>
</head>
<body>
<div id="container">
  <header>
    <h1>ğŸƒâ€â™€ï¸ å‡è‚¥è®ºå› Â· éšè—ç‰ˆ</h1>
    <button id="themeBtn">åˆ‡æ¢ä¸»é¢˜</button>
  </header>

  <div id="notesSection">
    <h3>ğŸ“ ç©å®¶ç¬”è®°</h3>
    <div id="notes">(æš‚æ— è®°å½•)</div>
  </div>

  <div id="forumInterface">
    <div id="postList" class="post-list"></div>
    <div id="postView" class="post-view hidden"></div>
  </div>
</div>

<script>
// ========== æ•°æ®ç»“æ„ ==========
const posts = [
  {
    id: 1,
    title: "ã€éšè—å­è®ºå›ã€‘åˆ†å‰²ä¸çŒ®ç¥­â€”â€”æè‡´å‡è‚¥æ³•",
    author: "èµ„æ·±å¸–å‹A",
    content: "å†…å®¹å·²éšè—ï¼Œè¾“å…¥å¯†ç æŸ¥çœ‹ã€‚",
    replies: []
  },
  {
    id: 2,
    title: "å­£åº¦èšä¼š Â· æ–°äººæŠ¥å‘Šè´´",
    author: "èµ„æ·±å¸–å‹B",
    content: "æ¯æ¬¡èšä¼šæ–°äººçš„æƒ…å†µå¦‚ä½•â€¦â€¦â† ç•™å¾…è§£é”",
    replies: []
  },
  {
    id: 3,
    title: "æ™®é€šè´´ï¼šæˆ‘çš„å¡è·¯é‡Œæ§åˆ¶ç»éªŒ",
    author: "æ™®é€šä¼šå‘˜C",
    content: "å¤§å®¶å¥½ï¼Œè¿™æ˜¯æˆ‘æœ€è¿‘ä¸€å‘¨çš„çƒ­é‡è®°å½•â€¦",
    replies: [
      {author:"ä¼šå‘˜D", text:"ä¸é”™ï¼ŒåšæŒä¸‹å»ï¼"},
      {author:"ä¼šå‘˜E", text:"è¯·é—®æ€ä¹ˆæ§åˆ¶æ™šé¤ï¼Ÿ"}
    ]
  }
];

let notes = [];
function updateNotes(){
  const nDiv = document.getElementById("notes");
  if(notes.length === 0) {
    nDiv.innerHTML = "(æš‚æ— è®°å½•)";
  } else {
    nDiv.innerHTML = notes.map(w=>`ğŸ“Œ ${w}`).join("<br>");
  }
}

function addNote(kw){
  if(!notes.includes(kw)){
    notes.push(kw);
    updateNotes();
  }
}

// ========== æ¸²æŸ“å¸–å­åˆ—è¡¨ ==========
function renderPostList(){
  const listDiv = document.getElementById("postList");
  listDiv.innerHTML = "";
  posts.forEach(p=>{
    const div = document.createElement("div");
    div.className = "post-item";
    div.innerHTML = `<p class="post-title">${p.title}</p><p class="post-meta">ä½œè€…ï¼š${p.author}</p>`;
    div.onclick = ()=>viewPost(p.id);
    listDiv.appendChild(div);
  });
}

// ========== æŸ¥çœ‹å•ä¸ªå¸–å­ ==========
function viewPost(id){
  const post = posts.find(p=>p.id===id);
  const viewDiv = document.getElementById("postView");
  viewDiv.classList.remove("hidden");
  viewDiv.innerHTML = `
    <h2>${post.title}</h2>
    <p>ä½œè€…ï¼š${post.author}</p>
    <div>${post.content}</div>
    <div class="reply-section">
      <h4>å›å¤ï¼š</h4>
      <div id="replies">${post.replies.map(r=>`<div class="reply-item"><strong>${r.author}ï¼š</strong>${r.text}</div>`).join("")}</div>
      <textarea id="replyText" rows="2" placeholder="è¾“å…¥å›å¤..."></textarea><br>
      <button onclick="submitReply(${post.id})">å‘è¡¨å›å¤</button>
      <button onclick="backToList()">è¿”å›åˆ—è¡¨</button>
    </div>
  `;
}

// ========== æäº¤å›å¤ ==========
function submitReply(postId){
  const txt = document.getElementById("replyText").value.trim();
  if(txt==="") return alert("è¯·è¾“å…¥å†…å®¹");
  const post = posts.find(p=>p.id===postId);
  post.replies.push({author:"ä½ ", text:txt});
  // åŠ å…¥ç¬”è®°ï¼šè®°å½•å…³é”®è¯â€œå›å¤â€
  addNote("å›å¤å¸–ï¼š"+post.title);
  viewPost(postId);
}

// ========== è¿”å›åˆ—è¡¨ ==========
function backToList(){
  document.getElementById("postView").classList.add("hidden");
}

// ========== å¯†ç è§£é”æœºåˆ¶ ==========
function unlockPost(id){
  const post = posts.find(p=>p.id===id);
  const pwd = prompt("è¯·è¾“å…¥å¯†ç æŸ¥çœ‹è¯¥å¸–ï¼š");
  if(pwd==="cut2025"){
    post.content = "ã€è§£é”å†…å®¹ã€‘æ¯å­£åº¦èšä¼šä¸€æ¬¡ï¼Œåœ°ç‚¹åœ¨éƒŠåŒºç‰§åœºã€‚æ–°äººå¾€å¾€åœ¨æ­¤è·å¾—çœŸæ­£çš„â€œå‡é‡å¯ç¤ºâ€ã€‚";
    updateNotes();
    renderPostList();
    viewPost(id);
  } else {
    alert("å¯†ç é”™è¯¯ï¼");
  }
}

// ========== åˆå§‹åŒ– ==========
renderPostList();
updateNotes();

// å¢åŠ äº¤äº’ï¼šç‚¹å‡»éšè—å¸–æ—¶å…ˆå¯†ç éªŒè¯
document.querySelectorAll(".post-item").forEach(div=>{
  // we can't bind easily here; instead: override viewPost to check
});

// æ”¹è¿›ï¼šåœ¨ viewPost åˆ¤æ–­å¦‚æœå†…å®¹ä¸ºâ€œå†…å®¹å·²éšè—â€ï¼Œæç¤ºè§£é”
const originalViewPost = viewPost;
viewPost = function(id){
  const post = posts.find(p=>p.id===id);
  if(post.content==="å†…å®¹å·²éšè—ï¼Œè¾“å…¥å¯†ç æŸ¥çœ‹ã€‚"){
    unlockPost(id);
  } else {
    originalViewPost(id);
  }
};

// ä¸»é¢˜åˆ‡æ¢
document.getElementById("themeBtn").onclick = ()=>{
  document.body.classList.toggle("dark");
};

</script>
</body>
</html>
